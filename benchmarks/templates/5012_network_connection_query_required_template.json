{
  "name": "network_connection_query",
  "description": "Network Connection Query events report information about active network connections.",
  "uid": 5012,
  "extends": "discovery_result",
  "category": "discovery",
  "profiles": [
    "cloud",
    "datetime",
    "osint",
    "host",
    "data_classification",
    "container",
    "linux/linux_users"
  ],
  "caption": "Network Connection Query",
  "category_uid": 5,
  "category_name": "Discovery",
  "attributes": {
    "connection_info": {
      "type": "object_t",
      "description": "The network connection information.",
      "group": "primary",
      "requirement": "required",
      "object_name": "Network Connection Information",
      "object_type": "network_connection_info",
      "caption": "Connection Info"
    },
    "query_result_id": {
      "type": "integer_t",
      "enum": {
        "3": {
          "description": "The target was not found.",
          "caption": "Does not exist"
        },
        "0": {
          "description": "The query result is unknown.",
          "caption": "Unknown"
        },
        "1": {
          "description": "The target was found.",
          "caption": "Exists"
        },
        "2": {
          "description": "The target was partially found.",
          "caption": "Partial"
        },
        "99": {
          "description": "The query result is not mapped. See the <code>query_result</code> attribute, which contains a data source specific value.",
          "caption": "Other"
        },
        "4": {
          "description": "The discovery attempt failed.",
          "caption": "Error"
        },
        "5": {
          "description": "Discovery of the target was not supported.",
          "caption": "Unsupported"
        }
      },
      "description": "The normalized identifier of the query result.",
      "group": "primary",
      "requirement": "required",
      "sibling": "query_result",
      "caption": "Query Result ID",
      "type_name": "Integer"
    },
    "process": {
      "type": "object_t",
      "description": "The process that owns the socket.",
      "group": "primary",
      "requirement": "required",
      "object_name": "Process",
      "object_type": "process",
      "caption": "Process",
      "attributes": {
        "pid": {
          "type": "integer_t",
          "description": "The process identifier, as reported by the operating system. Process ID (PID) is a number used by the operating system to uniquely identify an active process.",
          "requirement": "recommended",
          "caption": "Process ID",
          "type_name": "Integer",
          "observable": 15
        },
        "uid": {
          "type": "string_t",
          "description": "A unique identifier for this process assigned by the producer (tool).  Facilitates correlation of a process event with other events for that process.",
          "requirement": "recommended",
          "caption": "Unique ID",
          "type_name": "String"
        }
      },
      "constraints": {
        "at_least_one": [
          "pid",
          "uid"
        ]
      },
      "observable": 25,
      "name": "process",
      "profiles": [
        "container",
        "linux/linux_users",
        "data_classification",
        "datetime"
      ],
      "extends": "_entity"
    },
    "time": {
      "type": "timestamp_t",
      "description": "The normalized event occurrence time or the finding creation time.",
      "group": "occurrence",
      "requirement": "required",
      "caption": "Event Time",
      "type_name": "Timestamp"
    },
    "activity_id": {
      "type": "integer_t",
      "enum": {
        "0": {
          "description": "The event activity is unknown.",
          "caption": "Unknown"
        },
        "1": {
          "description": "The discovered results are via a query request.",
          "caption": "Query"
        },
        "99": {
          "description": "The event activity is not mapped. See the <code>activity_name</code> attribute, which contains a data source specific value.",
          "caption": "Other"
        }
      },
      "description": "The normalized identifier of the activity that triggered the event.",
      "group": "classification",
      "requirement": "required",
      "sibling": "activity_name",
      "caption": "Activity ID",
      "type_name": "Integer",
      "suppress_checks": [
        "sibling_convention"
      ]
    },
    "metadata": {
      "type": "object_t",
      "description": "The metadata associated with the event or a finding.",
      "group": "context",
      "requirement": "required",
      "object_name": "Metadata",
      "object_type": "metadata",
      "caption": "Metadata",
      "profiles": [
        "data_classification",
        "datetime"
      ],
      "name": "metadata",
      "extends": "object",
      "attributes": {
        "version": {
          "type": "string_t",
          "description": "The version of the OCSF schema, using Semantic Versioning Specification (<a target='_blank' href='https://semver.org'>SemVer</a>). For example: 1.0.0. Event consumers use the version to determine the available event attributes.",
          "requirement": "required",
          "caption": "Version",
          "type_name": "String"
        },
        "product": {
          "type": "object_t",
          "description": "The product that reported the event.",
          "requirement": "required",
          "object_name": "Product",
          "object_type": "product",
          "caption": "Product"
        }
      }
    },
    "type_uid": {
      "type": "long_t",
      "enum": {
        "501200": {
          "caption": "Network Connection Query: Unknown"
        },
        "501201": {
          "description": "The discovered results are via a query request.",
          "caption": "Network Connection Query: Query"
        },
        "501299": {
          "caption": "Network Connection Query: Other"
        }
      },
      "description": "The event/finding type ID. It identifies the event's semantics and structure. The value is calculated by the logging system as: <code>class_uid * 100 + activity_id</code>.",
      "group": "classification",
      "requirement": "required",
      "sibling": "type_name",
      "caption": "Type ID",
      "type_name": "Long"
    },
    "cloud": {
      "profile": "cloud",
      "type": "object_t",
      "description": "Describes details about the Cloud environment where the event was originally created or logged.",
      "group": "primary",
      "requirement": "required",
      "object_name": "Cloud",
      "object_type": "cloud",
      "caption": "Cloud",
      "name": "cloud",
      "extends": "object",
      "attributes": {
        "provider": {
          "type": "string_t",
          "description": "The unique name of the Cloud services provider, such as AWS, MS Azure, GCP, etc.",
          "requirement": "required",
          "caption": "Provider",
          "type_name": "String"
        }
      }
    },
    "class_uid": {
      "type": "integer_t",
      "enum": {
        "5012": {
          "description": "Network Connection Query events report information about active network connections.",
          "caption": "Network Connection Query"
        }
      },
      "description": "The unique identifier of a class. A class describes the attributes available in an event.",
      "group": "classification",
      "requirement": "required",
      "sibling": "class_name",
      "caption": "Class ID",
      "type_name": "Integer"
    },
    "state_id": {
      "type": "integer_t",
      "enum": {
        "3": {
          "description": "The socket has passively received a connection request from a remote peer.",
          "caption": "SYN_RECV"
        },
        "6": {
          "description": "The socket connection has been closed by the local application, the remote peer has closed its half of the connection, and the system is waiting to be sure that the remote peer received the last acknowledgement.",
          "caption": "TIME_WAIT"
        },
        "0": {
          "description": "The socket state is unknown.",
          "caption": "Unknown"
        },
        "1": {
          "description": "The socket has an established connection between a local application and a remote peer.",
          "caption": "ESTABLISHED"
        },
        "2": {
          "description": "The socket is actively trying to establish a connection to a remote peer.",
          "caption": "SYN_SENT"
        },
        "99": {
          "description": "The state is not mapped. See the <code>state</code> attribute, which contains a data source specific value.",
          "caption": "Other"
        },
        "4": {
          "description": "The socket connection has been closed by the local application, the remote peer has not yet acknowledged the close, and the system is waiting for it to close its half of the connection.",
          "caption": "FIN_WAIT1"
        },
        "5": {
          "description": "The socket connection has been closed by the local application, the remote peer has acknowledged the close, and the system is waiting for it to close its half of the connection.",
          "caption": "FIN_WAIT2"
        },
        "7": {
          "description": "The socket is not in use.",
          "caption": "CLOSED"
        },
        "8": {
          "description": "The socket connection has been closed by the remote peer, and the system is waiting for the local application to close its half of the connection.",
          "caption": "CLOSE_WAIT"
        },
        "9": {
          "description": "The socket connection has been closed by the remote peer, the local application has closed its half of the connection, and the system is waiting for the remote peer to acknowledge the close.",
          "caption": "LAST_ACK"
        },
        "10": {
          "description": "The socket is listening for incoming connections.",
          "caption": "LISTEN"
        },
        "11": {
          "description": "The socket connection has been closed by the local application and the remote peer simultaneously, and the remote peer has not yet acknowledged the close attempt of the local application.",
          "caption": "CLOSING"
        }
      },
      "description": "The state of the socket.",
      "group": "primary",
      "requirement": "required",
      "sibling": "state",
      "caption": "State ID",
      "type_name": "Integer"
    },
    "severity_id": {
      "type": "integer_t",
      "enum": {
        "3": {
          "description": "Action is required but the situation is not serious at this time.",
          "caption": "Medium"
        },
        "6": {
          "description": "An error occurred but it is too late to take remedial action.",
          "caption": "Fatal"
        },
        "0": {
          "description": "The event/finding severity is unknown.",
          "caption": "Unknown"
        },
        "1": {
          "description": "Informational message. No action required.",
          "caption": "Informational"
        },
        "2": {
          "description": "The user decides if action is needed.",
          "caption": "Low"
        },
        "99": {
          "description": "The event/finding severity is not mapped. See the <code>severity</code> attribute, which contains a data source specific value.",
          "caption": "Other"
        },
        "4": {
          "description": "Action is required immediately.",
          "caption": "High"
        },
        "5": {
          "description": "Action is required immediately and the scope is broad.",
          "caption": "Critical"
        }
      },
      "description": "<p>The normalized identifier of the event/finding severity.</p>The normalized severity is a measurement the effort and expense required to manage and resolve an event or incident. Smaller numerical values represent lower impact events, and larger numerical values represent higher impact events.",
      "group": "classification",
      "requirement": "required",
      "sibling": "severity",
      "caption": "Severity ID",
      "type_name": "Integer"
    },
    "osint": {
      "profile": "osint",
      "type": "object_t",
      "description": "The OSINT (Open Source Intelligence) object contains details related to an indicator such as the indicator itself, related indicators, geolocation, registrar information, subdomains, analyst commentary, and other contextual information. This information can be used to further enrich a detection or finding by providing decisioning support to other analysts and engineers.",
      "group": "primary",
      "is_array": true,
      "requirement": "required",
      "object_name": "OSINT",
      "object_type": "osint",
      "caption": "OSINT",
      "attributes": {
        "value": {
          "type": "string_t",
          "description": "The actual indicator value in scope, e.g., a SHA-256 hash hexdigest or a domain name.",
          "requirement": "required",
          "caption": "Indicator",
          "type_name": "String"
        },
        "type_id": {
          "type": "integer_t",
          "enum": {
            "3": {
              "description": "A hostname or computer name.",
              "caption": "Hostname"
            },
            "6": {
              "description": "A User Agent typically seen in HTTP request headers.",
              "caption": "User Agent"
            },
            "0": {
              "description": "The indicator type is ambiguous or there is not a related indicator for the OSINT object.",
              "caption": "Unknown"
            },
            "1": {
              "description": "An IPv4 or IPv6 address.",
              "caption": "IP Address"
            },
            "2": {
              "description": "A full-qualified domain name (FQDN), subdomain, or partial domain.",
              "caption": "Domain"
            },
            "99": {
              "description": "The indicator type is not directly listed.",
              "caption": "Other"
            },
            "4": {
              "description": "Any type of hash e.g., MD5, SHA1, SHA2, BLAKE, BLAKE2, etc. generated from a file, malware sample, request header, or otherwise.",
              "caption": "Hash"
            },
            "5": {
              "description": "A Uniform Resource Locator (URL) or Uniform Resource Indicator (URI).",
              "caption": "URL"
            },
            "7": {
              "description": "The serial number, fingerprint, or full content of an X.509 digital certificate.",
              "caption": "Digital Certificate"
            },
            "8": {
              "description": "The contents of an email or any related information to an email object.",
              "caption": "Email"
            },
            "9": {
              "description": "An email address.",
              "caption": "Email Address"
            },
            "10": {
              "description": "A CVE ID, CWE ID, or other identifier for a weakness, exploit, bug, or misconfiguration.",
              "caption": "Vulnerability"
            }
          },
          "description": "The OSINT indicator type ID.",
          "requirement": "required",
          "sibling": "type",
          "caption": "Indicator Type ID",
          "type_name": "Integer"
        },
        "name": {
          "type": "string_t",
          "description": "The name of the entity.",
          "requirement": "recommended",
          "caption": "Name",
          "type_name": "String"
        },
        "uid": {
          "type": "string_t",
          "description": "The unique identifier of the entity.",
          "requirement": "recommended",
          "caption": "Unique ID",
          "type_name": "String"
        }
      },
      "constraints": {
        "at_least_one": [
          "name",
          "uid"
        ]
      },
      "name": "osint",
      "profiles": [
        "data_classification"
      ],
      "extends": "_entity"
    },
    "category_uid": {
      "type": "integer_t",
      "enum": {
        "5": {
          "description": "Discovery events report the existence and state of devices, files, configurations, processes, registry keys, and other objects.",
          "uid": 5,
          "caption": "Discovery"
        }
      },
      "description": "The category unique identifier of the event.",
      "group": "classification",
      "requirement": "required",
      "sibling": "category_name",
      "caption": "Category ID",
      "type_name": "Integer"
    }
  }
}